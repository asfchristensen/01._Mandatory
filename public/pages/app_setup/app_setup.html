<div class="col-3 mt-5">
    <div class="buttons-header">
        <h3>Subjects</h3>
    </div>
    <div class="sidebar">
        <a href="#folders"><button class="subject">Folder structure</button></a>
        <a href="#component"><button class="sub-subject">Component</button></a>
        <a href="#install"><button class="subject">Install the packages needed</button></a>
        <a href="#instance"><button class="subject">Create a server instance</button></a>
    </div>
</div>

<div class="col-8 mt-5">
    <h1>app.js setup step-by-step</h1><br><br>

    <h6>
        <h3 id="folders">Folder structure</h3><br><br>
        It's important to follow a specific structure when it comes to folders in your project.<br><br><br> 
<pre>
    Project-name<br>
    <span><div class="folder"></div></span> public<br>
            <span><div class="folder"></div></span> assets<br>
                <span><div class="folder"></div></span> css
                    <span class="file-css">#</span> main.css<br>
                 <span><div class="folder"></div></span> images
                    <span class="file-img">[]</span> image.png<br>
                <span><div class="folder"></div></span> js
                    <span class="file-js">JS</span> footer.js<br>
            <span><div class="folder"></div></span> components<br>
                <span><div class="folder"></div></span> footer
                    <span class="file-html"><></span> footer.html<br>
                 <span><div class="folder"></div></span> navbar
                    <span class="file-html"><></span> navbar.html<br>
            <span><div class="folder"></div></span> pages<br>
                <span><div class="folder"></div></span> page1
                    <span class="file-css">#</span> page1.css
                    <span class="file-html"><></span> page1.html
                    <span class="file-js">JS</span> page1.js<br>
                <span><div class="folder"></div></span> page2
                    <span class="file-css">#</span> page2.css
                    <span class="file-html"><></span> page2.html
                    <span class="file-js">JS</span> page2.js<br>
                <span><div class="folder"></div></span> page3
                    <span class="file-css">#</span> page3.css
                    <span class="file-html"><></span> page3.html
                    <span class="file-js">JS</span> page3.js<br>
            .....<br>
    <span><div class="folder"></div></span> util
        <span class="file-js">JS</span> templateEngine.js<br><br>
    <span class="file-js">JS</span> app.js<br>
    <span class="file-js">{}</span> nodemon.json<br>
    <span class="file-js">{}</span> package.json<br>
</pre><br>

        Everything in <span class="emphasis">assets</span> folder is something that recurs on every html-page 
        throughout the project. That's why main.css targets main selectors (e.g. h1, body, components like navbar 
        etc.) and defines specific properties and values for each selector e.g. certain background-color for body 
        or font-size for h1 etc.<br><br>
    
        In the <span class="emphasis">components</span> folder you store "footer" and "navbar" (and other components 
        if used in the project). The html-page stored in the footer consists of everything from:<br><br>
<pre>
    <code>
        < /main > 
        < footer >  
        < /footer >

        ... script tags ...   

        < /body >
        < /html >
    </code>
</pre>   
    The html-page stored in navbar consits of everything from:<br><br>
<pre>
    <code>
        < !DOCTYPE html >
        < html lang="en" >

        < head >
        < meta charset="UTF-8">
        < meta http-equiv="X-UA-Compatible" content="IE=edge">
        < meta name="viewport" content="width=device-width, initial-scale=1.0">

        < link rel="stylesheet" href="/assets/css/main.css">
        $CSS_LINK

        < title >$TAB_TITLE< /title >
        < /head >
        < body >
            < header >
            < /header >
            < main >
    </code>
</pre>  
        In the <span class="emphasis">pages</span> folder you store all the html-pages. If some of the pages needs a different styling than the main.css it should be stored here in the individual page-folder e.g. in page1 or page2 folder etc.<br><br>

        In the <span class="emphasis">util</span> folder you store everything the client should not have access to! This is only for the server-side. It means that the client can't request anything inside this folder.<br><br>

        The same goes for the <span class="emphasis">root files</span> (app.js, nodemon.json, package.json). These have to be at the root of the project, because:<br><br>
        <p>
            app.js<br>
            Is the entry point for a Node.js application and it contains the code that initializes and starts the application. By convention, this file is located at the root of the project to make it easy to locate and execute.<br><br>
            package.json<br>
            Defines various metadata about the project and includes scripts that can be executed via the npm command-line tool. Therefor it needs to be located at the root because npm looks for it in the project's root directory.<br><br>
            nodemon.js<br>
            This file is used to configre the nodemon tool, and needs to be located at the root of the project because nodemon looks for it in the project's root directory. 
        </p><br>
        <h5 id="component">What is a component?</h5><br>
        A reusable structure that can be used throughout the project on every page. It's templates/styling that the developer chooses, and some of the typical components are: navbar, footer and body. These components are stored in a folder 
        called "assets". By having this folder you try to remove al logic from app.js and "clean up" the HTML pages, so there won't be any duplicate code.<br><br><br>
        

        <h3 id="install">Install the packages needed</h3><br>
        <p> 
            1) Create a package.json file and write the dependencies
        </p><br>
        <h5>Manually...</h5>
<pre>
    <code>
        {
            "dependencies": {
                "express": "4.18.2"
            }
        }
    </code>
</pre>
        <h5>Automatically...</h5><br>
        ... when creating a default package.json file without any dependencies installed:
<pre>
    <code>
        // in the terminal in the project folder 
        
        npm init -y
    </code>
</pre>
        This approach is what we are using during this course.<br><br>
        <p>
            2) Install the dependencies from the terminal 
        </p>
<pre>
    <code>
        sudo npm install express
    </code>
</pre>
        You know the package is installed if the "node_modules" folder has been added to the project.
        It will be greyed out because of being placed in .gitignore.<br><br><br>

        <h3 id="instance">Create a server instance</h3><br>
        <p>
            3) Make a "app.js" file<br><br>
            4) Import the package at the top of the script 
        </p>
<pre>
    <code>
    import express from "express"; 
    </code>
</pre>
        <p>
            5) Instansiate the package and assign the returned object to the constant variable "app"
        </p>
<pre>
    <code>
    const app = express();
    </code>
</pre>
            The "app" object is the central part of the application, because you can use it to define the 
            application's behaviour including various routes and middleware functions that determine how 
            the application responds to HTTP requests.<br><br>
            <p>
                6) Set the behaviour of the application 
            </p>
<pre>
    <code>
    // parses requests with JSON payloads
    // for POST requests

    app.use(express.json());

    // parses requests with URL-encoded payloads
    // for HTML form submits

    app.use(express.urlencoded({ extended: true }));

    // serving static files from the public directory
    // for CSS, HTML and JavaScript files 

    app.use(express.static("public"));
    </code>
</pre>
            "app.use()" is a method that allows you to register middleware functions. To be able to 
            parse incoming requests and populate req.body, and thereby set the behaviour of the application,
            you have to register middleware functions.<br><br>
            <p>
                7) Make the application listen on to a specific port e.g. 8080, since it's a HTTP dev port
            </p>
<pre>
    <code>
    const PORT = 8080;
    app.listen(PORT, (error) => {
        if (error) { 
            console.log(error); 
        }
        console.log("Server is running on port " + PORT);
    });
    </code>
</pre>
            This has to be at the bottom of the app.js file (common practice)<br><br>
            <p>
                8) Make routes 
            </p>
<pre>
    <code>
    app.get("/api/", (req, res) => { res.send({ data: ? }) });
    app.get("/test", (req, res) => { res.send(rendered page) });
    app.post("/api/", (req, res) => { res.send({ data: ? }) });
    app.patch("/api/", (req, res) => { res.send({ data: ? }) });
    app.delete("/api/", (req, res) => { res.send({ data: ? }) });
    </code>
</pre>
        All endpoints that return data in JSON has an "/api/" included, because it is a commmon convention to do so, when it's not something that 
        is intended to be accessed for clients. It's in a machine-readable format. The route with "/test" returns a HTML-page which is intended to 
        be accessed by the client.<br><br>   
        <p>
            9) Check if the endpoints work by writing "localhost:8080/endpoint" in the browser or 
            use Postman to do it.
        </p>
        <p>
            10) If you have frontend, and not just a pure API like the above code examples, see <a href="/serve_html">Serving HTML</a>
        </p>
    </h6>
</div>
